import{s as c,a as B,c as G,b as X,i as Y}from"./utilities-cLnRvzqj.js";let A="page-header";class R extends HTMLElement{constructor(){super()}connectedCallback(){this.setClass(),this.render()}render(){let t=c("hgroup",{class:"logo-wrap"}),s=B(),e=c("h1").inner("Newsify");t.append(s,e);let i=c("div",{class:`${this.className}__profile`}),n="John D.",a=c("div"),o=c("p").inner(this.timeSpecificGreeting()),h=c("p").inner(n);a.append(o,h);let p=this.profileSettingsBtn(n),d=this.settingsDialog();i.append(a,p,d),this.append(t,i),this.toggleSettingsDialog(p,d)}profileSettingsBtn(t){let s=c("button");{let e=t.split(" ");e=e[0].substring(0,1)+e[1].substring(0,1);let i=c("p").inner(e);s.append(i),s.style.backgroundColor=this.stringToHslColor(t,100,90),i.style.color=this.stringToHslColor(t,100,25)}return s}toggleSettingsDialog(t,s){t.onclick=()=>{s.open?s.close():s.showModal()};let e=window.innerHeight-t.getBoundingClientRect().bottom-8;s.style.height=e+"px"}settingsDialog(){let t=c("dialog",{class:"settings-dialog"}),s=c("h2").inner("Profile Settings"),e=c("i",{class:"fas fa-cog"});s.prepend(e);let i=c("p").inner("Choose which categories you would like displayed on the home page");return t.append(s,i),G().forEach(a=>{let o=c("div",{class:"settings-item"}),h=X(a.title,a.icon),p=c("input",{type:"checkbox",role:"switch",id:"hellohello"});p.checked=!0,o.append(h,p),t.append(o)}),t.onclick=a=>{var o=t.getBoundingClientRect(),h=o.top<=a.clientY&&a.clientY<=o.top+o.height&&o.left<=a.clientX&&a.clientX<=o.left+o.width;h||t.close()},t}timeSpecificGreeting(){var t=new Date,s=t.getHours();let e;return s<5?e="Hello there":s<12?e="Good Morning":s<18?e="Good Afternoon":e="Good Evening",e}stringToHslColor(t,s,e){for(var i=0,n=0;n<t.length;n++)i=t.charCodeAt(n)+((i<<5)-i);var a=i%360;return"hsl("+a+", "+s+"%, "+e+"%)"}setClass(){this.className=this.getAttribute("class")||A,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`)}}customElements.define(A,R);const ie=A;let H="news-section";class z extends HTMLElement{set dataObject(t){this.props=t}constructor(){super(),this.props={}}connectedCallback(){this.setClass(),this.render()}render(){let t=c("details"),s=c("summary"),e=X(this.props.title,this.props.icon),i=c("i",{class:"fas fa-chevron-right"}),n=c("div",{class:"content-div"});s.append(e,i),t.append(s,n),this.append(t),this.monitorItems(n,this)}monitorItems(t,s){const e=function(a,o){t.childElementCount<1&&s.remove()},i=new MutationObserver(e),n={childList:!0};i.observe(t,n)}setClass(){this.className=this.getAttribute("class")||H,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`),this.role="region"}}customElements.define(H,z);const ae=H;function W(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var S={exports:{}};/*!
 * Clamp.js 0.7.0
 *
 * Copyright 2011-2013, Joseph Schmitt http://joe.sh
 * Released under the WTFPL license
 * http://sam.zoy.org/wtfpl/
 */var U=S.exports,P;function J(){return P||(P=1,function(r,t){(function(s,e){r.exports=e()})(U,function(){function s(e,i){i=i||{};var n=window,a={clamp:i.clamp||2,useNativeClamp:typeof i.useNativeClamp<"u"?i.useNativeClamp:!0,splitOnChars:i.splitOnChars||[".","-","–","—"," "],animate:i.animate||!1,truncationChar:i.truncationChar||"…",truncationHTML:i.truncationHTML},o=e.style,h=e.innerHTML,p=typeof e.style.webkitLineClamp<"u",d=a.clamp,u=d.indexOf&&(d.indexOf("px")>-1||d.indexOf("em")>-1),m;a.truncationHTML&&(m=document.createElement("span"),m.innerHTML=a.truncationHTML);function k(l,f){return n.getComputedStyle||(n.getComputedStyle=function(y,O){return this.el=y,this.getPropertyValue=function(v){var j=/(\-([a-z]){1})/g;return v=="float"&&(v="styleFloat"),j.test(v)&&(v=v.replace(j,function(){return arguments[2].toUpperCase()})),y.currentStyle&&y.currentStyle[v]?y.currentStyle[v]:null},this}),n.getComputedStyle(l,null).getPropertyValue(f)}function T(l){var f=l||e.clientHeight,y=_(e);return Math.max(Math.floor(f/y),0)}function q(l){var f=_(e);return f*l}function _(l){var f=k(l,"line-height");return f=="normal"&&(f=parseInt(k(l,"font-size"))*1.2),parseInt(f)}var w=a.splitOnChars.slice(0),b=w[0],g,M;function x(l){return l.lastChild.children&&l.lastChild.children.length>0?x(Array.prototype.slice.call(l.children).pop()):!l.lastChild||!l.lastChild.nodeValue||l.lastChild.nodeValue===""||l.lastChild.nodeValue==a.truncationChar?(l.lastChild.parentNode.removeChild(l.lastChild),x(e)):l.lastChild}function L(l,f){if(!f)return;function y(){w=a.splitOnChars.slice(0),b=w[0],g=null,M=null}var O=l.nodeValue.replace(a.truncationChar,"");if(g||(w.length>0?b=w.shift():b="",g=O.split(b)),g.length>1?(M=g.pop(),N(l,g.join(b))):g=null,m&&(l.nodeValue=l.nodeValue.replace(a.truncationChar,""),e.innerHTML=l.nodeValue+" "+m.innerHTML+a.truncationChar),g){if(e.clientHeight<=f)if(w.length>=0&&b!=="")N(l,g.join(b)+b+M),g=null;else return e.innerHTML}else b===""&&(N(l,""),l=x(e),y());if(a.animate)setTimeout(function(){L(l,f)},a.animate===!0?10:a.animate);else return L(l,f)}function N(l,f){l.nodeValue=f+a.truncationChar}d=="auto"?d=T():u&&(d=T(parseInt(d)));var $;if(p&&a.useNativeClamp)o.overflow="hidden",o.textOverflow="ellipsis",o.webkitBoxOrient="vertical",o.display="-webkit-box",o.webkitLineClamp=d,u&&(o.height=a.clamp+"px");else{var I=q(d);I<=e.clientHeight&&($=L(x(e),I))}return{original:h,clamped:$}}return s})}(S)),S.exports}var K=J();const F=W(K);function C(){return new Promise((r,t)=>{const s=indexedDB.open("articlesNYT",1);s.onupgradeneeded=e=>{const i=e.target.result;if(!i.objectStoreNames.contains("articles")){const n=i.createObjectStore("articles",{keyPath:"id"});n.createIndex("published_date","published_date",{unique:!1}),n.createIndex("category","category",{unique:!1})}if(!i.objectStoreNames.contains("favorites")){const n=i.createObjectStore("favorites",{keyPath:"id"});n.createIndex("published_date","published_date",{unique:!1}),n.createIndex("category","category",{unique:!1})}},s.onsuccess=e=>{r(e.target.result)},s.onerror=e=>{t(e.target.error)}})}async function ne(r){const s=(await C()).transaction("articles","readwrite"),e=s.objectStore("articles");return r.forEach(i=>{e.put(i)}),s.complete}async function re(r){const e=(await C()).transaction("articles","readwrite").objectStore("articles"),i=e.index("category");return new Promise((n,a)=>{let o=26784e5,h=20;const p=i.getAll(r);p.onsuccess=()=>{let d=p.result;d.forEach((u,m)=>{let k=Math.floor(new Date(u.pub_date).getTime());(Date.now()-k>o||m>=h)&&(console.log("Article is old and will be deleted"),e.delete(u.id))}),n(d)},p.onerror=()=>a(p.error)})}async function Q(r){const s=(await C()).transaction(["favorites"],"readwrite");return s.objectStore("favorites").put({id:r.id,title:r.title,abstract:r.abstract,thumbnail:r.thumbnail,byline:r.byline,category:r.category,pub_date:r.pub_date,url:r.url,favoritedAt:new Date().toISOString()}),s.complete}async function Z(r){const s=(await C()).transaction(["favorites"],"readwrite");return s.objectStore("favorites").delete(r),s.complete}async function V(r){const t=await C();return new Promise((s,e)=>{const a=t.transaction(["favorites"],"readonly").objectStore("favorites").get(r);a.onsuccess=()=>s(!!a.result),a.onerror=()=>e(a.error)})}async function oe(r){const i=(await C()).transaction("favorites","readonly").objectStore("favorites").index("category");return new Promise((n,a)=>{const o=i.getAll(r);o.onsuccess=()=>{n(o.result)},o.onerror=()=>{a(o.error)}})}async function le(){const e=(await C()).transaction("favorites","readonly").objectStore("favorites").getAll();return new Promise((i,n)=>{e.onsuccess=()=>{const a=[...new Set(e.result.map(o=>o.category))];i(a)},e.onerror=()=>{n(e.error)}})}let E="article-item";class ee extends HTMLElement{set dataObject(t){this.props=t}constructor(){super(),this.props={}}connectedCallback(){this.setClass(),this.render()}render(){let t=Y(this.className),s=c("img",{class:`${this.className}__img`,src:this.props.thumbnail});t.append(s);let e=c("article"),i=c("hgroup"),n=c("a",{href:this.props.url,target:"_blank"}).inner(this.props.title),a=c("h3",{lang:"en"}),o=c("i",{class:"fas fa-external"});a.append(o,n);let h=c("p").inner(this.byline());F(h,{clamp:1}),i.append(a,h);let p=c("p",{class:"summary"}).inner(this.props.abstract||"This article has no preview.");e.append(i,p);let d=c("div",{class:`${this.className}__swipe-box`}),u=c("i",{class:"far fa-bookmark"});d.append(u),this.append(t,e,d),this.clampText(p,i),this.handleSwipe(d,u)}clampText(t,s){new ResizeObserver(()=>{let e=2;s.clientHeight>40&&(e=1),F(t,{clamp:e})}).observe(this)}byline(){let t=this.formatDate();return this.props.byline&&(t+=` — ${this.props.byline}`),t}handleSwipe(t,s){const e=this;let i=0,n=0,a=!1,o=-90,h=!1,p=!1;e.addEventListener("click",d=>{let u=d.clientX-i;Math.abs(u)<5&&window.open(this.props.url,"_blank").focus()}),e.addEventListener("pointerdown",async d=>{i=d.clientX,a=!0,h=!1,p=!1,e.style.transition="none",e.setPointerCapture(d.pointerId),await V(this.props.id)?(t.style.backgroundColor="#FF5D5D",s.className="fas fa-trash-alt"):(t.style.backgroundColor="#4D861F",s.className="far fa-bookmark")}),e.addEventListener("pointermove",d=>{if(!a)return;let u=d.clientX-i;u<0?(n=u,n<-104&&(n=-104),h=!0):h?(n=u,n>0&&(n=0)):n=0,n<=o?s.classList.add("activated"):s.classList.remove("activated"),Math.abs(u)>5&&(p=!0),e.style.transform=`translateX(${n}px)`}),e.addEventListener("pointerup",async d=>{a=!1,e.releasePointerCapture(d.pointerId);let u="";if(n<=o?(u="transform 300ms 2000ms ease",await V(this.props.id)?(window.location.pathname==="/saved"&&(u+=", opacity 300ms ease",e.style.opacity=.2,setTimeout(()=>e.remove(),300)),Z(this.props.id)):Q(this.props)):u="transform 300ms ease",e.style.transition=u,e.style.transform="translateX(0)",s.className="far fa-check-circle",!p){const m=document.elementFromPoint(d.clientX,d.clientY);m&&m.closest("a")&&m.click()}})}formatDate(){const t=this.props.pub_date,s=new Date(t),e={weekday:"long",year:"numeric",month:"long",day:"numeric"};return s.toLocaleDateString("en-US",e)}setClass(){this.className=this.getAttribute("class")||E,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`)}}customElements.define(E,ee);const ce=E;let D="nav-footer";class te extends HTMLElement{constructor(){super()}connectedCallback(){this.setClass(),this.render()}render(){let t=c("nav");this.linkArray().forEach(e=>{let i=this.createNavLink(e.title,e.href,e.icon);t.append(i)}),this.append(t)}linkArray(){return[{title:"Home",icon:"fas fa-home",href:"/"},{title:"Saved",icon:"fas fa-bookmark",href:"/saved"},{title:"Popular",icon:"fas fa-star",href:"/popular"}]}createNavLink(t,s,e){let i=c("i",{class:e}),n=c("a",{href:s}).inner(t);return s===window.location.pathname&&n.setAttribute("aria-current","page"),n.prepend(i),n}setClass(){this.className=this.getAttribute("class")||D,this._classModifier=this.getAttribute("class-mod"),this._classModifier&&this.classList.add(`${this.className}--${this._classModifier}`)}}customElements.define(D,te);const de=D;export{ce as A,de as N,ie as P,ae as a,oe as b,re as c,le as g,ne as s};
