import"./modulepreload-polyfill-B5Qt9EMX.js";const R="data:image/svg+xml,%3csvg%20width='174'%20height='252'%20viewBox='0%200%20174%20252'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2033_460)'%3e%3cpath%20d='M35.3626%2033.9095C54.7517%2033.9095%2070.5243%2049.7541%2070.5243%2069.2319V216.577C70.5243%20236.054%2054.7517%20251.899%2035.3626%20251.899C15.9734%20251.899%200.200928%20236.054%200.200928%20216.577V69.2319C0.200928%2049.7541%2015.9734%2033.9095%2035.3626%2033.9095Z'%20fill='url(%23paint0_linear_2033_460)'/%3e%3cpath%20d='M138.838%200C158.228%200%20174%2015.8446%20174%2035.3224V151.382C174%20170.859%20158.228%20186.704%20138.838%20186.704C119.449%20186.704%20103.677%20170.859%20103.677%20151.382V35.3224C103.677%2015.8446%20119.449%200%20138.838%200Z'%20fill='url(%23paint1_linear_2033_460)'/%3e%3cpath%20d='M173.699%20154.712C172.192%20162.786%20155.515%20171.869%20148.081%20158.244C141.953%20146.941%20124.975%20120.904%20119.349%20112.224L67.5105%2018.1658C58.067%201.11017%2036.6687%20-5.04601%2019.6906%204.44057C-3.5161%2018.1658%200.200988%2037.7445%200.200988%2089.2143C1.70792%2081.1406%2019.6906%2077.0028%2027.1248%2090.6272C34.559%20104.252%20106.892%20235.247%20106.892%20235.247C116.335%20252.303%20144.062%20254.422%20155.113%20249.477C165.36%20244.936%20171.589%20233.935%20172.594%20222.228C175.206%20208.503%20173.196%20187.511%20173.699%20154.712Z'%20fill='url(%23paint2_linear_2033_460)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_2033_460'%20x1='35.3935'%20y1='33.8992'%20x2='35.3935'%20y2='251.889'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.165'%20stop-color='%235F5001'/%3e%3cstop%20offset='1'%20stop-color='%23FDD201'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_2033_460'%20x1='138.869'%20y1='0'%20x2='138.869'%20y2='186.704'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%234F8620'/%3e%3cstop%20offset='1'%20stop-color='%2325430C'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint2_linear_2033_460'%20x1='21.2245'%20y1='14.55'%20x2='157.451'%20y2='235.102'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFD403'/%3e%3cstop%20offset='1'%20stop-color='%232F5B0B'/%3e%3c/linearGradient%3e%3cclipPath%20id='clip0_2033_460'%3e%3crect%20width='174'%20height='252'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";function o(a,t){function i(s,n){Object.keys(n).forEach(r=>s.setAttribute(r,n[r]))}if(typeof a!="string")throw new Error("setElement: 'tag' must be a valid string.");let e=document.createElement(a);return t&&typeof t=="object"&&i(e,t),e.inner=function(s){return typeof s<"u"&&(this.innerHTML=String(s)),this},e}function B(){return o("img",{class:"company-logo",src:R})}function Z(a){return o("figure",{class:`${a}__img-wrap`})}function q(a,t){let i=o("hgroup",{class:"section-title"}),e=o("i",{class:t}),s=o("h2").inner(a);return i.append(e,s),i}function X(){return[{title:"Europe",icon:"fas fa-euro"},{title:"Health",icon:"fas fa-doctor"},{title:"Sports",icon:"fas fa-ball"},{title:"Business",icon:"fas fa-chart"},{title:"Travel",icon:"far fa-map"}]}let N="page-header";class J extends HTMLElement{constructor(){super()}connectedCallback(){this.setClass(),this.render()}render(){let t=o("hgroup",{class:"logo-wrap"}),i=B(),e=o("h1").inner("Newsify");t.append(i,e);let s=o("div",{class:`${this.className}__profile`}),n="John D.",r=o("div"),d=o("p").inner(this.timeSpecificGreeting()),h=o("p").inner(n);r.append(d,h);let u=this.profileSettingsBtn(n),c=this.settingsDialog();s.append(r,u,c),this.append(t,s),this.toggleSettingsDialog(u,c)}profileSettingsBtn(t){let i=o("button");{let e=t.split(" ");e=e[0].substring(0,1)+e[1].substring(0,1);let s=o("p").inner(e);i.append(s),i.style.backgroundColor=this.stringToHslColor(t,100,90),s.style.color=this.stringToHslColor(t,100,25)}return i}toggleSettingsDialog(t,i){t.onclick=()=>{i.open?i.close():i.showModal()};let e=window.innerHeight-t.getBoundingClientRect().bottom-8;i.style.height=e+"px"}settingsDialog(){let t=o("dialog",{class:"settings-dialog"}),i=o("h2").inner("Profile Settings"),e=o("i",{class:"fas fa-cog"});i.prepend(e);let s=o("p").inner("Choose which categories you would like displayed on the home page");return t.append(i,s),X().forEach(r=>{let d=o("div",{class:"settings-item"}),h=q(r.title,r.icon),u=o("input",{type:"checkbox",role:"switch",id:"hellohello"});u.checked=!0,d.append(h,u),t.append(d)}),t.onclick=r=>{var d=t.getBoundingClientRect(),h=d.top<=r.clientY&&r.clientY<=d.top+d.height&&d.left<=r.clientX&&r.clientX<=d.left+d.width;h||t.close()},t}timeSpecificGreeting(){var t=new Date,i=t.getHours();let e;return i<5?e="Hello there":i<12?e="Good Morning":i<18?e="Good Afternoon":e="Good Evening",e}stringToHslColor(t,i,e){for(var s=0,n=0;n<t.length;n++)s=t.charCodeAt(n)+((s<<5)-s);var r=s%360;return"hsl("+r+", "+i+"%, "+e+"%)"}setClass(){this.className=this.getAttribute("class")||N,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`)}}customElements.define(N,J);const K=N;let E="news-section";class Q extends HTMLElement{set dataObject(t){this.props=t}constructor(){super(),this.props={}}connectedCallback(){this.setClass(),this.render()}render(){let t=o("details"),i=o("summary"),e=q(this.props.title,this.props.icon),s=o("i",{class:"fas fa-chevron-right"}),n=o("div",{class:"content-div"});i.append(e,s),t.append(i,n),this.append(t),this.monitorItems(n,this)}monitorItems(t,i){const e=function(r,d){t.childElementCount<1&&i.remove()},s=new MutationObserver(e),n={childList:!0};s.observe(t,n)}setClass(){this.className=this.getAttribute("class")||E,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`),this.role="region"}}customElements.define(E,Q);const ee=E;function te(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var x={exports:{}};/*!
 * Clamp.js 0.7.0
 *
 * Copyright 2011-2013, Joseph Schmitt http://joe.sh
 * Released under the WTFPL license
 * http://sam.zoy.org/wtfpl/
 */var ie=x.exports,P;function se(){return P||(P=1,function(a,t){(function(i,e){a.exports=e()})(ie,function(){function i(e,s){s=s||{};var n=window,r={clamp:s.clamp||2,useNativeClamp:typeof s.useNativeClamp<"u"?s.useNativeClamp:!0,splitOnChars:s.splitOnChars||[".","-","–","—"," "],animate:s.animate||!1,truncationChar:s.truncationChar||"…",truncationHTML:s.truncationHTML},d=e.style,h=e.innerHTML,u=typeof e.style.webkitLineClamp<"u",c=r.clamp,p=c.indexOf&&(c.indexOf("px")>-1||c.indexOf("em")>-1),m;r.truncationHTML&&(m=document.createElement("span"),m.innerHTML=r.truncationHTML);function w(l,f){return n.getComputedStyle||(n.getComputedStyle=function(b,F){return this.el=b,this.getPropertyValue=function(C){var j=/(\-([a-z]){1})/g;return C=="float"&&(C="styleFloat"),j.test(C)&&(C=C.replace(j,function(){return arguments[2].toUpperCase()})),b.currentStyle&&b.currentStyle[C]?b.currentStyle[C]:null},this}),n.getComputedStyle(l,null).getPropertyValue(f)}function T(l){var f=l||e.clientHeight,b=$(e);return Math.max(Math.floor(f/b),0)}function z(l){var f=$(e);return f*l}function $(l){var f=w(l,"line-height");return f=="normal"&&(f=parseInt(w(l,"font-size"))*1.2),parseInt(f)}var v=r.splitOnChars.slice(0),y=v[0],g,M;function _(l){return l.lastChild.children&&l.lastChild.children.length>0?_(Array.prototype.slice.call(l.children).pop()):!l.lastChild||!l.lastChild.nodeValue||l.lastChild.nodeValue===""||l.lastChild.nodeValue==r.truncationChar?(l.lastChild.parentNode.removeChild(l.lastChild),_(e)):l.lastChild}function L(l,f){if(!f)return;function b(){v=r.splitOnChars.slice(0),y=v[0],g=null,M=null}var F=l.nodeValue.replace(r.truncationChar,"");if(g||(v.length>0?y=v.shift():y="",g=F.split(y)),g.length>1?(M=g.pop(),k(l,g.join(y))):g=null,m&&(l.nodeValue=l.nodeValue.replace(r.truncationChar,""),e.innerHTML=l.nodeValue+" "+m.innerHTML+r.truncationChar),g){if(e.clientHeight<=f)if(v.length>=0&&y!=="")k(l,g.join(y)+y+M),g=null;else return e.innerHTML}else y===""&&(k(l,""),l=_(e),b());if(r.animate)setTimeout(function(){L(l,f)},r.animate===!0?10:r.animate);else return L(l,f)}function k(l,f){l.nodeValue=f+r.truncationChar}c=="auto"?c=T():p&&(c=T(parseInt(c)));var I;if(u&&r.useNativeClamp)d.overflow="hidden",d.textOverflow="ellipsis",d.webkitBoxOrient="vertical",d.display="-webkit-box",d.webkitLineClamp=c,p&&(d.height=r.clamp+"px");else{var O=z(c);O<=e.clientHeight&&(I=L(_(e),O))}return{original:h,clamped:I}}return i})}(x)),x.exports}var ne=se();const V=te(ne);function S(){return new Promise((a,t)=>{const i=indexedDB.open("articlesNYT",1);i.onupgradeneeded=e=>{const s=e.target.result;if(!s.objectStoreNames.contains("articles")){const n=s.createObjectStore("articles",{keyPath:"id"});n.createIndex("published_date","published_date",{unique:!1}),n.createIndex("category","category",{unique:!1})}if(!s.objectStoreNames.contains("favorites")){const n=s.createObjectStore("favorites",{keyPath:"id"});n.createIndex("published_date","published_date",{unique:!1}),n.createIndex("category","category",{unique:!1})}},i.onsuccess=e=>{a(e.target.result)},i.onerror=e=>{t(e.target.error)}})}async function ae(a){const i=(await S()).transaction("articles","readwrite"),e=i.objectStore("articles");return a.forEach(s=>{e.put(s)}),i.complete}async function re(a){const e=(await S()).transaction("articles","readwrite").objectStore("articles"),s=e.index("category");return new Promise((n,r)=>{let d=26784e5,h=20;const u=s.getAll(a);u.onsuccess=()=>{let c=u.result;c.forEach((p,m)=>{let w=Math.floor(new Date(p.pub_date).getTime());(Date.now()-w>d||m>=h)&&(console.log("Article is old and will be deleted"),e.delete(p.id))}),n(c)},u.onerror=()=>r(u.error)})}async function oe(a){const i=(await S()).transaction(["favorites"],"readwrite");return i.objectStore("favorites").put({id:a.id,title:a.title,abstract:a.abstract,thumbnail:a.thumbnail,byline:a.byline,category:a.category,pub_date:a.pub_date,url:a.url,favoritedAt:new Date().toISOString()}),i.complete}async function le(a){const i=(await S()).transaction(["favorites"],"readwrite");return i.objectStore("favorites").delete(a),i.complete}async function G(a){const t=await S();return new Promise((i,e)=>{const r=t.transaction(["favorites"],"readonly").objectStore("favorites").get(a);r.onsuccess=()=>i(!!r.result),r.onerror=()=>e(r.error)})}let D="article-item";class ce extends HTMLElement{set dataObject(t){this.props=t}constructor(){super(),this.props={}}connectedCallback(){this.setClass(),this.render()}render(){let t=Z(this.className),i=o("img",{class:`${this.className}__img`,src:this.props.thumbnail});t.append(i);let e=o("article"),s=o("hgroup"),n=o("a",{href:this.props.url,target:"_blank"}).inner(this.props.title),r=o("h3",{lang:"en"}),d=o("i",{class:"fas fa-external"});r.append(d,n);let h=o("p").inner(this.byline());V(h,{clamp:1}),s.append(r,h);let u=o("p",{class:"summary"}).inner(this.props.abstract||"This article has no preview.");e.append(s,u);let c=o("div",{class:`${this.className}__swipe-box`}),p=o("i",{class:"far fa-bookmark"});c.append(p),this.append(t,e,c),this.clampText(u,s),this.handleSwipe(c,p)}clampText(t,i){new ResizeObserver(()=>{let e=2;i.clientHeight>40&&(e=1),V(t,{clamp:e})}).observe(this)}byline(){let t=this.formatDate();return this.props.byline&&(t+=` — ${this.props.byline}`),t}handleSwipe(t,i){const e=this;let s=0,n=0,r=!1,d=-90,h=!1,u=!1;e.addEventListener("click",c=>{let p=c.clientX-s;Math.abs(p)<5&&window.open(this.props.url,"_blank").focus()}),e.addEventListener("pointerdown",async c=>{s=c.clientX,r=!0,h=!1,u=!1,e.style.transition="none",e.setPointerCapture(c.pointerId),await G(this.props.id)?(t.style.backgroundColor="#FF5D5D",i.className="fas fa-trash-alt"):(t.style.backgroundColor="#4D861F",i.className="far fa-bookmark")}),e.addEventListener("pointermove",c=>{if(!r)return;let p=c.clientX-s;p<0?(n=p,n<-104&&(n=-104),h=!0):h?(n=p,n>0&&(n=0)):n=0,n<=d?i.classList.add("activated"):i.classList.remove("activated"),Math.abs(p)>5&&(u=!0),e.style.transform=`translateX(${n}px)`}),e.addEventListener("pointerup",async c=>{r=!1,e.releasePointerCapture(c.pointerId);let p="";if(n<=d?(p="transform 300ms 2000ms ease",await G(this.props.id)?(window.location.pathname==="/saved"&&(p+=", opacity 300ms ease",e.style.opacity=.2,setTimeout(()=>e.remove(),300)),le(this.props.id)):oe(this.props)):p="transform 300ms ease",e.style.transition=p,e.style.transform="translateX(0)",i.className="far fa-check-circle",!u){const m=document.elementFromPoint(c.clientX,c.clientY);m&&m.closest("a")&&m.click()}})}formatDate(){const t=this.props.pub_date,i=new Date(t),e={weekday:"long",year:"numeric",month:"long",day:"numeric"};return i.toLocaleDateString("en-US",e)}setClass(){this.className=this.getAttribute("class")||D,this.classModifier=this.getAttribute("class-mod"),this.classModifier&&this.classList.add(`${this.className}--${this.classModifier}`)}}customElements.define(D,ce);const de=D;function pe(){return"ZIlfSqviIIl000Si2V335gWv3C2zzGyL"}const ue=pe(),he=2;function fe(a){const t=localStorage.getItem(a);return t?(Date.now()-Number(t))/(1e3*60)>he:!0}function me(a){localStorage.setItem(a,Date.now())}function ge(a,t){let i=a,e=t;return e!=""&&e.length<i.length&&(i=e),i}async function ye(a){if(fe("articlesCategoryTimestamp")){console.log("Fetching fresh articles from API...");let t=`https://api.nytimes.com/svc/search/v2/articlesearch.json?q=${a}&begin_date=${be()}&api-key=${ue}&sort=newest`;const e=await(await fetch(t)).json();console.log(e);const s=e.response.docs.filter(n=>n.multimedia.thumbnail.url!==void 0&&n.multimedia.thumbnail.url!=="").map(n=>({id:n.uri,title:ge(n.headline.main,n.headline.print_headline),abstract:n.abstract,thumbnail:n.multimedia.thumbnail.url,byline:n.byline.original,category:a,pub_date:n.pub_date,url:n.web_url}));return await ae(s),me("articlesCategoryTimestamp"),s}else{console.log("Loading articles from cache...");const t=await re(a);return t.sort(function(i,e){return new Date(e.pub_date)-new Date(i.pub_date)}),t}}function be(){const a=new Date,t=new Date;return t.setDate(a.getDate()-7),(s=>s.toISOString().slice(0,10).replace(/-/g,""))(t)}let A="nav-footer";class Ce extends HTMLElement{constructor(){super()}connectedCallback(){this.setClass(),this.render()}render(){let t=o("nav");this.linkArray().forEach(e=>{let s=this.createNavLink(e.title,e.href,e.icon);t.append(s)}),this.append(t)}linkArray(){return[{title:"Home",icon:"fas fa-home",href:"/"},{title:"Saved",icon:"fas fa-bookmark",href:"/saved"},{title:"Popular",icon:"fas fa-star",href:"/popular"}]}createNavLink(t,i,e){let s=o("i",{class:e}),n=o("a",{href:i}).inner(t);return i===window.location.pathname&&n.setAttribute("aria-current","page"),n.prepend(s),n}setClass(){this.className=this.getAttribute("class")||A,this._classModifier=this.getAttribute("class-mod"),this._classModifier&&this.classList.add(`${this.className}--${this._classModifier}`)}}customElements.define(A,Ce);const ve=A;let H="splash-screen";class we extends HTMLElement{constructor(){super()}connectedCallback(){this.setClass(),this.render()}render(){let t=o("div"),i=B(),e=o("p").inner("Newsify");t.append(i,e),this.append(t);let s=600;setTimeout(()=>{i.style.transition=`width ${s}ms ease`,i.style.width="180px",e.style.transition=`opacity ${s}ms ${s}ms ease`,e.style.opacity="1",this.style.transition=`opacity ${s}ms ${s*4}ms ease`,this.style.opacity=0},300),setTimeout(()=>{this.remove()},s*5)}setClass(){this.className=this.getAttribute("class")||H,this._classModifier=this.getAttribute("class-mod"),this._classModifier&&this.classList.add(`${this.className}--${this._classModifier}`)}}customElements.define(H,we);const Se=H;let _e=o(Se),xe=document.querySelector("#app"),U=o("header"),W=o("main"),Y=o("footer");xe.append(_e,U,W,Y);U.append(o(K));async function Te(){X().forEach(t=>{let i=o(ee);i.dataObject=t,W.append(i);let e=i.querySelector(".content-div");ye(t.title).then(s=>{s.forEach(n=>{let r=o(de);r.dataObject=n,e.append(r),i.firstChild.setAttribute("open","")})})})}Te();Y.append(o(ve));
