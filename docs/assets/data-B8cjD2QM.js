import{g as f,a as p}from"./utilities-66Lwi-4b.js";import{s as r,c}from"./css-anchor-positioning-DGS6dOe4.js";function h(){return"ZIlfSqviIIl000Si2V335gWv3C2zzGyL"}const l=h(),g=2;function u(e){const t=f(e);return t?(Date.now()-Number(t))/(1e3*60)>g:!0}function m(e){p(e,Date.now())}function b(e,t){let s=e,n=t;return n!=""&&n.length<s.length&&(s=n),s}async function D(e){if(u("articlesCategoryTimestamp")){console.log("Fetching fresh articles from API...");let t=`https://api.nytimes.com/svc/search/v2/articlesearch.json?q=${e}&begin_date=${w()}&api-key=${l}&sort=newest`;const n=await(await fetch(t)).json();console.log(n);const o=n.response.docs.filter(a=>a.multimedia.default.url!==void 0&&a.multimedia.default.url!=="").map(a=>({id:a.uri,title:b(a.headline.main,a.headline.print_headline),abstract:a.abstract,thumbnail:a.multimedia.default.url,byline:a.byline.original,category:e,pub_date:a.pub_date,url:a.web_url}));return await r(o),m("articlesCategoryTimestamp"),o}else{console.log("Loading articles from cache...");const t=await c(e);return t.sort(function(s,n){return new Date(n.pub_date)-new Date(s.pub_date)}),t}}function w(){const e=new Date,t=new Date;return t.setDate(e.getDate()-7),(o=>o.toISOString().slice(0,10).replace(/-/g,""))(t)}async function A(e){if(u("articlesPopularTimestamp")){console.log("Fetching fresh articles from API...");let t=e.toLowerCase().replaceAll(" ","-");switch(t){case"today":t=1;break;case"this-week":t=7;break;case"this-month":t=30;break}let s=`https://api.nytimes.com/svc/mostpopular/v2/viewed/${t}.json?api-key=${l}`;const o=await(await fetch(s)).json();console.log(o);const a=o.results.filter(i=>i.media&&i.media.length>0).map(i=>({id:i.uri,title:i.title,abstract:i.abstract,thumbnail:i.media[0]["media-metadata"][1].url||0,byline:i.byline.original,category:e,pub_date:i.published_date,url:i.url})).sort(function(i,d){return new Date(d.pub_date)-new Date(i.pub_date)});return await r(a),m("articlesPopularTimestamp"),a}else{console.log("Loading articles from cache...");const t=await c(e);return t.sort(function(s,n){return new Date(n.pub_date)-new Date(s.pub_date)}),t}}export{A as a,D as f};
